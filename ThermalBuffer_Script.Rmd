---
title: "ThermalBuffer_Script"
output:
  word_document: default
  html_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Data wrangling packages
library(tidyverse)
library(dplyr)
library(ggplot2)
library(lubridate)
library(patchwork)
library(astsa)
library(weathermetrics)
library(report)
library(car)
library(multcomp)
library(MetBrewer)
library(multcompView)

# Time series analysis packages
library(MARSS)
library(MASS)
library(forecast)
library(zoo)
library(imputeTS) 
```
#Hourly Data
###Data Wrangling
```{r}
#Read in data
quarterHour_condensed <- readRDS('quarterHour_condensed.RDS')
quarterHour_condensed <- as.data.frame(t(quarterHour_condensed))
quarterHour_condensed <- quarterHour_condensed %>% mutate_all(~ifelse(is.nan(.), NA, .))

#Create 15 min sequence
quarterHour <- seq(mdy_h('7/1/2020 00'),mdy_h('7/13/2021 00'),by = "15 mins")
quarterHour <- as.data.frame(quarterHour)

#Attach to data frame
quarterHour_condensed <- cbind(quarterHour_condensed,quarterHour)

#Format data long
quarterHour_long <- gather(quarterHour_condensed, site, value, -quarterHour)
```

#Seasonal buffering
##Summer 
###Data wrangling
```{r}
#Read in data
daily_maxs_condensed <- readRDS('daily_maxs_condensed.RDS')
daily_maxs_condensed <- as.data.frame(t(daily_maxs_condensed))
daily_maxs_condensed <- daily_maxs_condensed %>% mutate_all(~ifelse(is.nan(.), NA, .))

#Create "day" sequence 
day <- seq(mdy('7/1/2020'),mdy('7/13/2021'),by = "day") 
day <- as.data.frame(day) #convert "day" to data frame

#Attach day to data frame
daily_maxs_condensed <- cbind(daily_maxs_condensed,day)

#Format data long
daily_max_long <- gather(daily_maxs_condensed, site, value, -day)
data_summer <- daily_max_long %>%filter(day>'2020-07-15'& day < '2020-09-15')

#Make a column for habitat
data_summer['habitat'] <- NA
data_summer$habitat <- with(data_summer, ifelse(site == "SC" | site == "HC",as.character("creek"), as.character("pond")))
```

###Seiad Creek 
####ANOVA 
```{r}
data_summer_SC<- subset(data_summer, site %in% c("AP","SP","Durazo","LS","May","SC"))
data_summer_SC$site<-as.factor(data_summer_SC$site)
data_summer_SC$habitat<-as.factor(data_summer_SC$habitat)
write.csv(data_summer_SC,"data_summer_SC.csv")

#Check boxplots
ggplot(data_summer_SC, aes(x=site, y=value)) + 
  geom_boxplot() + theme_classic()

#Variances are okay, but not great. Now check the residuals.
leveneTest(value ~ site, data = data_summer_SC) #Levene's Test fails
anova_SC <- aov(value~site*habitat, data = data_summer_SC) #run one way anova
anova_SC_residuals <- residuals(object = anova_SC ) #Pull out residuals
ggplot(anova_SC, aes(x = .fitted, y = .resid)) +
  geom_point() + theme_classic()
#Residuals do not look great. 

#Check normality
shapiro.test(x = anova_SC_residuals) #check for normality. Shows some issue here too. 

#The preliminary inspection of raw data and residuals aren't ideal. Let's try transformations.
##Log
data_summer_SC<- data_summer_SC %>% mutate(logvalue=log(value)) #Log
ggplot(data_summer_SC, aes(x=site, y=logvalue)) + 
  geom_boxplot() + theme_classic()

##Log10
data_summer_SC<- data_summer_SC %>% mutate(log10value=log10(value)) #Log10
ggplot(data_summer_SC, aes(x=site, y=log10value)) + 
  geom_boxplot() + theme_classic()

##Square Root
data_summer_SC<- data_summer_SC %>% mutate(sqrtvalue=sqrt(value)) #Square root
ggplot(data_summer_SC, aes(x=site, y=sqrtvalue)) + 
  geom_boxplot() + theme_classic()
##They all look about the same

leveneTest(logvalue ~ site, data = data_summer_SC) 
leveneTest(log10value ~ site, data = data_summer_SC) 
leveneTest(sqrtvalue ~ site, data = data_summer_SC) 
##All fail, but the graph isn't awful. I think it's good enough. So, try the ANOVA again and stick with the untransformed data to ease interpretation. 

#Anova (untransformed)
anova_SC <- aov(value~site*habitat, data = data_summer_SC) #run one way anova
summary(anova_SC) ##This is CRAZY significant. Even if we were way off on our assumptions (they aren't that bad), we could easily absorb the increased error.

```
####PostHoc
```{r}
#Posthoc analysis
anova_SC <- aov(value ~ site*habitat, data = data_summer_SC)
summary(anova_SC)##Note the degrees of freedom. 
tukey<-TukeyHSD(anova_SC)
print(tukey)

##To help label
groups <- multcompLetters4(anova_SC, tukey)
print(groups)
```
####Boxplot
```{r}
#Boxplot
b1 <- ggplot(subset(data_summer, site %in% c("AP","SP","Durazo","LS","May","SC")))+
  geom_boxplot(aes(x = site, value, col = day))+
  labs(title = "(a) Seiad Creek, 15 July - 15 September")+
  theme_classic()+
  theme(text=element_text(size=16), axis.title.x=element_blank())+
  scale_x_discrete(name ="Site", 
                   limits = c("AP","SP","Durazo","LS","May","SC"),
                    labels=c("AP" = "Alexander","SP"= "Stender","Durazo"=
                               "Durazo","LS" = "LowerSeiad","May"="May","SC" = "SeiadCreek"))+
  scale_y_continuous(name="Daily Maximum Temp (C)",limits=c(12.5, 22.5))

b1
```

###Horse Creek

####ANOVA Horse Creek
```{r}
#ANOVA
data_summer_HC <- subset(data_summer, site %in% c("FG","UL","LL","GP","HC"))
data_summer_HC$site<-as.factor(data_summer_HC$site)

#Check boxplots
ggplot(data_summer_HC, aes(x=site, y=value)) + 
  geom_boxplot() + theme_classic()

#Variances are okay, but not great. Now check the residuals.
leveneTest(value ~ site, data = data_summer_HC) #Levene's Test for for equal variances fails
anova_HC <- aov(value ~ site, data = data_summer_HC) #run one way anova
anova_HC_residuals <- residuals(object = anova_HC ) #Pull out residuals

ggplot(anova_HC, aes(x = .fitted, y = .resid)) +
  geom_point() + theme_classic()
#Residuals do not look great. 

#Check normality
shapiro.test(x = anova_HC_residuals) #check for normality. Shows some issue here too. 

#The preliminary inspection of raw data and residuals aren't ideal. Let's try transformations.
##Log
data_summer_HC<- data_summer_HC %>% mutate(logvalue=log(value)) #Log
ggplot(data_summer_HC, aes(x=site, y=logvalue)) + 
  geom_boxplot() + theme_classic()

##Log10
data_summer_HC<- data_summer_HC %>% mutate(log10value=log10(value)) #Log10
ggplot(data_summer_HC, aes(x=site, y=log10value)) + 
  geom_boxplot() + theme_classic()

##Square Root
data_summer_HC<- data_summer_HC %>% mutate(sqrtvalue=sqrt(value)) #Square root
ggplot(data_summer_HC, aes(x=site, y=sqrtvalue)) + 
  geom_boxplot() + theme_classic()

##They all look about the same

leveneTest(logvalue ~ site, data = data_summer_HC) 
leveneTest(log10value ~ site, data = data_summer_HC) 
leveneTest(sqrtvalue ~ site, data = data_summer_HC) 
##All fail, but the graph isn't awful. I think it's good enough. So, try the ANOVA again and stick with the untransformed data to ease interpretation. 

#Anova (untransformed)
anova_HC <- aov(value ~ site, data = data_summer_HC) #run one way anova
summary(anova_HC) ##This is CRAZY significant. Even if we were way off on our assumptions (they aren't that bad), we could easily absorb the increased error.

#To be safe, let's check a non-parametric test to see if we get a similar result.
kruskal.test(value ~ site, data = data_summer_HC) ##Also  significant. This is pretty solid evidence that what you're seeing in the ANOVA is legit. 
 
```
####PostHoc
```{r}
#Posthoc analysis
anova_HC <- aov(value ~ site*habitat, data = data_summer_HC)
summary(anova_HC)##Note the degrees of freedom. 
tukey2<-TukeyHSD(anova_HC)
print(tukey2)

ggplot(data_summer_HC, aes(x=site, y=value)) + 
  geom_boxplot() + theme_classic()
#Looking at the eyeball test, It's not Crazy that Tukey would be picking up these differences. Remember, the ANOVA is testing for differences in means, so the black bar does seem to be quite different in most cases, even with the error overlap. 

##To help you label
groups2 <- multcompLetters4(anova_2C, tukey2)
print(groups2)
```

####Boxplot
```{r}
#Boxplot
b2 <- ggplot(subset(data_summer, site %in% c("FG","UL","LL","GP","HC")))+
  geom_boxplot(aes(x = site, value, col = day))+
  labs(title = "(b) Horse Creek, 15 July - 15 September")+
  theme_classic()+
  theme(text=element_text(size=16), axis.title.x=element_blank())+
  scale_x_discrete(name ="Site", 
                   limits = c("FG","UL","LL","GP","HC"),
                    labels=c("FG" = "FishGulch","UL"= "UpperLaw","LL"=
                               "LowerLaw","GP" = "Goodman","HC"="HorseCreek"))+
  scale_y_continuous(name="Daily Maximum Temp (C)",limits=c(12.5, 22.5))
```

##Winter 
###Data wrangling
```{r}
#Read in data
daily_mins_condensed <- readRDS('daily_mins_condensed.RDS')
daily_mins_condensed <- as.data.frame(t(daily_mins_condensed))
daily_mins_condensed <- daily_mins_condensed %>% mutate_all(~ifelse(is.nan(.), NA, .))

#Create "day" sequence 
day <- seq(mdy('7/1/2020'),mdy('7/13/2021'),by = "day") 
day <- as.data.frame(day) #convert "day" to data frame

#Attach day to data frame
daily_mins_condensed <- cbind(daily_mins_condensed,day)

#Format data long
daily_min_long <- gather(daily_mins_condensed, site, value, -day)
data_winter <- daily_min_long %>%filter(day>'2020-12-15'& day < '2021-02-15')
```

###Seiad Creek 
```{r}
#Boxplot
b3 <- ggplot(subset(data_winter, site %in% c("AP","SP","Durazo","LS","May","SC")))+
  geom_boxplot(aes(x = site, value, col = day))+
  labs(title = "(c) Seiad Creek, 15 December - 15 February")+
  theme_classic()+
  theme(text=element_text(size=16))+
  scale_x_discrete(name ="Site", 
                   limits = c("AP","SP","Durazo","LS","May","SC"),
                    labels=c("AP" = "Alexander","SP"= "Stender","Durazo"=
                               "Durazo","LS" = "LowerSeiad","May"="May","SC" = "SeiadCreek"))+
  scale_y_continuous(name="Daily Minimum Temp (C)",limits=c(4, 12))
```

####ANOVA Seiad Creek 
```{r}
#ANOVA
data_winter_SC<- subset(data_winter, site %in% c("AP","SP","Durazo","LS","May","SC"))
data_winter_SC$site<-as.factor(data_winter_SC$site)

#Check boxplots
ggplot(data_winter_SC, aes(x=site, y=value)) + 
  geom_boxplot() + theme_classic()


#Variances are okay, but not great. Now check the residuals.
leveneTest(value ~ site, data = data_winter_SC) #Levene's Test for for equal variances fails
anova_SC <- aov(value ~ site, data = data_winter_SC) #run one way anova

anova_SC_residuals <- residuals(object = anova_SC ) #Pull out residuals

ggplot(anova_SC, aes(x = .fitted, y = .resid)) +
  geom_point() + theme_classic()
#Residuals look ok. 

#Check normality
shapiro.test(x = anova_SC_residuals) #check for normality. Seems ok. 

#The preliminary inspection of raw data and residuals are fine, but let's try transformations just in case.
##Log
data_winter_SC<- data_winter_SC %>% mutate(logvalue=log(value)) #Log
ggplot(data_winter_SC, aes(x=site, y=logvalue)) + 
  geom_boxplot() + theme_classic()

##Log10
data_winter_SC<- data_winter_SC %>% mutate(log10value=log10(value)) #Log10
ggplot(data_winter_SC, aes(x=site, y=log10value)) + 
  geom_boxplot() + theme_classic()

##Square Root
data_winter_SC<- data_winter_SC %>% mutate(sqrtvalue=sqrt(value)) #Square root
ggplot(data_winter_SC, aes(x=site, y=sqrtvalue)) + 
  geom_boxplot() + theme_classic()

##They all look about the same

leveneTest(logvalue ~ site, data = data_winter_SC) 
leveneTest(log10value ~ site, data = data_winter_SC) 
leveneTest(sqrtvalue ~ site, data = data_winter_SC) 
##All fail, but the graph isn't awful. I think it's good enough. So, try the ANOVA again and stick with the untransformed data to ease interpretation. 

#Anova (untransformed)
anova_SC <- aov(value ~ site, data = data_winter_SC) #run one way anova
summary(anova_SC) ##This is CRAZY significant. Even if we were way off on our assumptions (they aren't that bad), we could easily absorb the increased error.

#To be safe, let's check a non-parametric test to see if we get a similar result.
kruskal.test(value ~ site, data = data_winter_SC) ##Also  significant. This is pretty solid evidence that what you're seeing in the ANOVA is legit. 

#Posthoc analysis
TukeyHSD(anova_SC) 
report(anova_SC)
```

###Horse Creek
```{r}
#Boxplot
b4 <- ggplot(subset(data_winter, site %in% c("FG","UL","LL","GP","HC")))+
  geom_boxplot(aes(x = site, value, col = day))+
  labs(title = "(d) Horse Creek, 15 December - 15 February")+
  theme_classic()+
  theme(text=element_text(size=16))+
  scale_x_discrete(name ="Site", 
                   limits = c("FG","UL","LL","GP","HC"),
                    labels=c("FG" = "FishGulch","UL"= "UpperLaw","LL"=
                               "LowerLaw","GP" = "Goodman","HC"="HorseCreek"))+
  scale_y_continuous(name="Daily Minimum Temp (C)",limits=c(4, 12))
```

####ANOVA Horse Creek 
```{r}
#ANOVA
data_winter_HC <- subset(data_winter, site %in% c("FG","UL","LL","GP","HC"))
data_winter_HC$site<-as.factor(data_winter_HC$site)

#Check boxplots
ggplot(data_winter_HC, aes(x=site, y=value)) + 
  geom_boxplot() + theme_classic()

#Variances are okay, but not great. Now check the residuals.
leveneTest(value ~ site, data = data_winter_HC) #Levene's Test for for equal variances fails
anova_HC <- aov(value ~ site, data = data_winter_HC) #run one way anova

anova_HC_residuals <- residuals(object = anova_HC ) #Pull out residuals

ggplot(anova_HC, aes(x = .fitted, y = .resid)) +
  geom_point() + theme_classic()
#Residuals are ok, not great. 

#Check normality
shapiro.test(x = anova_SC_residuals) #check for normality. Shows some issue here too. 

#The preliminary inspection of raw data and residuals aren't ideal. Let's try transformations.
##Log
data_winter_HC<- data_winter_HC %>% mutate(logvalue=log(value)) #Log
ggplot(data_winter_HC, aes(x=site, y=logvalue)) + 
  geom_boxplot() + theme_classic()

##Log10
data_winter_HC<- data_winter_HC %>% mutate(log10value=log10(value)) #Log10
ggplot(data_winter_HC, aes(x=site, y=log10value)) + 
  geom_boxplot() + theme_classic()

##Square Root
data_winter_HC<- data_winter_HC %>% mutate(sqrtvalue=sqrt(value)) #Square root
ggplot(data_winter_HC, aes(x=site, y=sqrtvalue)) + 
  geom_boxplot() + theme_classic()

##They all look about the same

leveneTest(logvalue ~ site, data = data_winter_HC) 
leveneTest(log10value ~ site, data = data_winter_HC) 
leveneTest(sqrtvalue ~ site, data = data_winter_HC) 
##All fail, but the graph isn't awful. I think it's good enough. So, try the ANOVA again and stick with the untransformed data to ease interpretation. 

#Anova (untransformed)
anova_HC <- aov(value ~ site, data = data_winter_HC) #run one way anova
summary(anova_HC) ##This is CRAZY significant. Even if we were way off on our assumptions (they aren't that bad), we could easily absorb the increased error.

#To be safe, let's check a non-parametric test to see if we get a similar result.
kruskal.test(value ~ site, data = data_winter_HC) ##Also  significant. This is pretty solid evidence that what you're seeing in the ANOVA is legit. 

TukeyHSD(anova_HC) 
report(anova_HC)
```
##Boxplot Figure
```{r}
png("Fig_Boxplots.png",width = 1000, height = 600)
(b1 + b2) / (b3 + b4)
dev.off()
```

#Daily Buffering
##Data wrangling
```{r}
quarterHour_condensed$day <- lubridate::floor_date(quarterHour_condensed$quarterHour, unit="day") #Bin by day

#Create a function for coefficient of variance (CV)
CV <- function(x){
        (sd(x)/mean(x))*100
}
```

##Individual CVs
```{r}
#Alexander Pond 
AP_CV <- quarterHour_condensed %>%       #15 min data
  group_by(day) %>%                      #Group by day
  dplyr::select(AP) %>%                  #Select site
  summarize(CV = CV(AP))                 #Calculate CV per day for one site
AP_CV_mean <- mean(AP_CV$CV,na.rm=T)     #Take all days as mean over entire year
plot(AP_CV$day,AP_CV$CV)                 #Plot a time series of CV

#Stender Pond
SP_CV <- quarterHour_condensed %>% 
  group_by(day) %>% 
  dplyr::select(SP) %>%
  summarize(CV = CV(SP))
SP_CV_mean <- mean(SP_CV$CV,na.rm=T)
plot(SP_CV$day,SP_CV$CV)

#Durazo Pond
Durazo_CV <- quarterHour_condensed %>% 
  group_by(day) %>% 
  dplyr::select(Durazo) %>%
  summarize(CV = CV(Durazo))
Durazo_CV_mean <- mean(Durazo_CV$CV,na.rm=T)
plot(Durazo_CV$day,Durazo_CV$CV)

#Lower Seiad 
LS_CV <- quarterHour_condensed %>% 
  group_by(day) %>% 
  dplyr::select(LS) %>%
  summarize(CV = CV(LS))
LS_CV_mean <- mean(LS_CV$CV,na.rm=T)
plot(LS_CV$day,LS_CV$CV)

#May Pond
May_CV <- quarterHour_condensed %>% 
  group_by(day) %>% 
  dplyr::select(May) %>%
  summarize(CV = CV(May))
May_CV_mean <- mean(May_CV$CV,na.rm=T)
plot(May_CV$day,May_CV$CV)

#Fish Gulch
FG_CV <- quarterHour_condensed %>% 
  group_by(day) %>% 
  dplyr::select(FG) %>%
  summarize(CV = CV(FG))
FG_CV_mean <- mean(FG_CV$CV,na.rm=T)
plot(FG_CV$day,FG_CV$CV)

#Goodman Pond
GP_CV <- quarterHour_condensed %>% 
  group_by(day) %>% 
  dplyr::select(GP) %>%
  summarize(CV = CV(GP))
GP_CV_mean <- mean(GP_CV$CV,na.rm=T)
plot(GP_CV$day,GP_CV$CV)

#Upper Lawrence
UL_CV <- quarterHour_condensed %>% 
  group_by(day) %>% 
  dplyr::select(UL) %>%
  summarize(CV = CV(UL))
UL_CV_mean <- mean(UL_CV$CV,na.rm=T)
plot(UL_CV$day,UL_CV$CV)

#Lower Lawrence
LL_CV <- quarterHour_condensed %>% 
  group_by(day) %>% 
  dplyr::select(LL) %>%
  summarize(CV = CV(LL))
LL_CV_mean <- mean(LL_CV$CV,na.rm=T)
plot(LL_CV$day,LL_CV$CV)

#Seiad Creek
SC_CV <- quarterHour_condensed %>% 
  group_by(day) %>% 
  dplyr::select(SC) %>%
  summarize(CV = CV(SC))
SC_CV_mean <- mean(SC_CV$CV,na.rm=T)
plot(SC_CV$day,SC_CV$CV)

#Horse Creek
HC_CV <- quarterHour_condensed %>% 
  group_by(day) %>% 
  dplyr::select(HC) %>%
  summarize(CV = CV(HC))
HC_CV_mean <- mean(HC_CV$CV,na.rm=T)
plot(HC_CV$day,HC_CV$CV)

```

##CV Ratios
```{r}
#CV Ratios are Creeks/Ponds
#No Buffering = <1
#Buffering = >1

#Alexander Pond 
SC_AP <- SC_CV_mean/AP_CV_mean

#Stender Pond
SC_SP <- SC_CV_mean/SP_CV_mean

#Durazo Pond
SC_Durazo <- SC_CV_mean/Durazo_CV_mean

#Lower Seiad 
SC_LS <- SC_CV_mean/LS_CV_mean

#May Pond
SC_May <- SC_CV_mean/May_CV_mean

#Fish Gulch
HC_FG <- HC_CV_mean/FG_CV_mean

#Goodman Pond
HC_GP <- HC_CV_mean/GP_CV_mean

#Upper Lawrence
HC_UL <- HC_CV_mean/UL_CV_mean

#Lower Lawrence
HC_LL <- HC_CV_mean/LL_CV_mean
```

##CV Data Table
```{r}
data.frame(Creek=c("Seiad Creek","Seiad Creek","Seiad Creek","Seiad Creek","Seiad Creek","Horse Creek","Horse Creek","Horse Creek","Horse Creek"),
           CreekCV=round(c(SC_CV_mean,SC_CV_mean,SC_CV_mean,SC_CV_mean,SC_CV_mean,HC_CV_mean,HC_CV_mean,HC_CV_mean,HC_CV_mean),2),
           Pond=c("Alexander","Stender","Durazo","Lower Seiad","May","Fish Gulch","Goodman","Upper Lawrence","Lower Lawrence"),
           PondCV=round(c(AP_CV_mean,SP_CV_mean,Durazo_CV_mean,LS_CV_mean,May_CV_mean,FG_CV_mean,GP_CV_mean,UL_CV_mean,LL_CV_mean),2),
           CV_Ratio=(round(c(SC_AP, 
                        SC_SP,
                        SC_Durazo,
                        SC_LS,
                        SC_May,
                        HC_FG,
                        HC_GP,
                        HC_UL,
                        HC_LL),2)))

```
#Figure 3: Time Series Examples Figure
```{r}

daily_means_condensed <- readRDS('daily_means_condensed.RDS')
daily_means_condensed <- as.data.frame(t(daily_means_condensed))
daily_means_condensed <- daily_means_condensed %>% mutate_all(~ifelse(is.nan(.), NA, .))
day <- seq(mdy('7/1/2020'),mdy('7/13/2021'),by = "day") 
day <- as.data.frame(day) #convert "day" to data frame

#Attach day to data frame
daily_means_condensed <- cbind(daily_means_condensed,day)
daily_means_condensed$day <- as.POSIXct(daily_means_condensed$day)

mycolors <- met.brewer(name="Archambault",n=4,type="discrete")

p1 <- ggplot()+
  geom_line(data = quarterHour_condensed, aes(x = quarterHour, y = AP), color ="#D3D3D3", size = 1) +
  geom_line(data = daily_means_condensed, aes(x = day, y = AP), color ="#88a0dc", size = 1) +
  labs(title = "(a) Alexander Pond", x = "Date", y = "Temperature (C)")+
  scale_y_continuous(name="Daily Mean Temp (C)",limits=c(0, 25))+
  theme_classic()+
  theme(text=element_text(size=16),legend.position = "none",axis.title.x=element_blank())
p2 <- ggplot()+
  geom_line(data = quarterHour_condensed, aes(x = quarterHour, y = UL), color ="#D3D3D3", size = 1) +
  geom_line(data = daily_means_condensed, aes(x = day, y = UL), color = "#ed968c", size = 1) +
  labs(title = "(c) Upper Lawrence Pond", x = "Date", y = "Temperature (C)")+
  scale_y_continuous(name="Daily Mean Temp (C)",limits=c(0, 25))+
  theme_classic()+
  theme(text=element_text(size=16),legend.position = "none")
p3 <- ggplot()+
  geom_line(data = quarterHour_condensed, aes(x = quarterHour, y = SC), color ="#D3D3D3", size = 1) +
  geom_line(data = daily_means_condensed, aes(x = day, y = SC), color = "#e78429", size = 1) +
  labs(title = "(b) Seiad Creek", x = "Date", y = "Temperature (C)")+
  scale_y_continuous(name="Daily Mean Temp (C)",limits=c(0, 25))+
  theme_classic()+
  theme(text=element_text(size=16),legend.position = "none", axis.title.x=element_blank())
p4 <- ggplot()+
  geom_line(data = quarterHour_condensed, aes(x = quarterHour, y = HC), color ="#D3D3D3", size = 1) +
  geom_line(data = daily_means_condensed, aes(x = day, y = HC), color = "#f9d14a", size = 1) +
  labs(title = "(d) Horse Creek", x = "Date", y = "Temperature (C)")+
  scale_y_continuous(name="Daily Mean Temp (C)",limits=c(0, 25))+
  theme_classic()+
  theme(text=element_text(size=16),legend.position = "none")

png("Fig_TempTimeSeries.png",width = 1000, height = 600)
(p1 + p3) / (p2 + p4)
dev.off()


```
#May Pond Example
```{r}
May <- readRDS("May.rds")
MayCk <- readRDS("MayCk.rds")

May_August <-May %>%filter(day>'2020-08-01'& day < '2020-08-31')
May_August <- May_August[,c("Temp","date")]         
MayCk_August <-MayCk %>%filter(day>'2020-08-01'& day < '2020-08-31')
MayCk_August <- MayCk_August[,c("Temp","date")] 

png("Fig_MayPond.png", width = 700, height = 400)
ggplot()+
  geom_line(data = May_August, aes(x = date, y = Temp, color = "May Pond"))+
  geom_line(data = MayCk_August, aes(x = date, y = Temp, color = "Seiad Creek"))+
  labs(x = "Date",
       y = "Hourly Temperature (C)",
       title = "May Pond and Seiad Creek, August 2020")+
  theme_classic()+
  theme(text=element_text(size=16), legend.position = "bottom")+
  scale_colour_manual("", values = c("May Pond"="#88a0dc", "Seiad Creek"="#ed968c")) +
  scale_y_continuous("Hourly Temperature (C)") 
dev.off()
```

